---
title: "simulations_BR02"
output: word_document
date: "2024-11-20"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyr)
library(purrr)
library(dplyr)
library(stringr)
library(data.table)
library(readr)
library(writexl)
library(stringr)
library(ggplot2)

long_df <- read.csv("C:/Users/rocpa/OneDrive/Documenti/GitHub/tragedynatural/Roma_BR/BR02/BR02_simulations.csv",sep=",")

long_df[long_df$output == "capital",]$output <- "Capitale totale"
long_df[long_df$output == "ccr",]$output <- "Contributo comune rigenerazione"
long_df[long_df$output == "daysurvived",]$output <- "Giorni in vita farmers"
long_df[long_df$output == "energiaaquisita",]$output <- "Energia acquisita"
long_df[long_df$output == "giornaliero",]$output <- "Guadagno giornaliero"
long_df[long_df$output == "mucche",]$output <- "Mucche in vita"
long_df[long_df$output == "muccheperse",]$output <- "Mucche perse"
long_df[long_df$output == "muccheslider",]$output <- "Mucche acquisite a settimana"
long_df[long_df$output == "giorno",]$output <- "Giorno"
long_df[long_df$output == "risenergtot",]$output <- "Risorse ambientali"
long_df[long_df$condition == "pre",]$condition <- "Prima simulazione"
long_df[long_df$condition == "post",]$condition <- "Seconda simulazione"

```

## Explorative by groups

- Here used rinnovo energetico 0.32, not malus

```{r read_data, echo=FALSE}

variables <- c("Capitale totale","Guadagno giornaliero","Contributo comune rigenerazione","Mucche acquisite a settimana",
         "Mucche in vita","Mucche perse","Energia acquisita","Risorse ambientali","Giorni in vita farmers","Giorno")

for (i in variables){
 
plot_i <- long_df[long_df$output == i,] %>% ggplot(aes(x = time, y = score)) + geom_line(aes(color = color)) +
  scale_color_manual("gruppo", values=c(azzurro="cyan", blu="blue", rosso = "red",giallo = "yellow",rosa = "pink")) +
  scale_x_continuous(breaks=seq(0,35,7)) +
facet_grid(turn ~ factor(condition, levels = c("Prima simulazione","Seconda simulazione")), scales = "free_y") +
  labs(title = i, x = "giorni", y = i) + 
  theme_bw( ) + 
  theme(
    axis.text.x = element_text(angle = 45),legend.position = "bottom")
  
plot(plot_i)

}
```