---
title: "simulations_genova24"
output: word_document
date: "2024-11-11"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyr)
library(purrr)
library(dplyr)
library(stringr)
library(data.table)
library(readr)
library(writexl)
library(stringr)
library(ggplot2)

long_dfGE <- read.csv("C:/Users/rocpa/OneDrive/Documenti/GitHub/GENOVA_wya/archiviati/simulationsGE24.csv",sep=",")

long_dfGE[long_dfGE$output == "capital",]$output <- "Capitale totale"
long_dfGE[long_dfGE$output == "ccr",]$output <- "Contributo comune rigenerazione"
long_dfGE[long_dfGE$output == "daysurvived",]$output <- "Giorni in vita farmers"
long_dfGE[long_dfGE$output == "energiaaquisita",]$output <- "Energia acquisita"
long_dfGE[long_dfGE$output == "giornaliero",]$output <- "Guadagno giornaliero"
long_dfGE[long_dfGE$output == "mucche",]$output <- "Mucche in vita"
long_dfGE[long_dfGE$output == "muccheperse",]$output <- "Mucche perse"
long_dfGE[long_dfGE$output == "muccheslider",]$output <- "Mucche acquisite a settimana"
long_dfGE[long_dfGE$output == "giorno",]$output <- "Giorno"
long_dfGE[long_dfGE$output == "risenergtot",]$output <- "Risorse ambientali"
long_dfGE[long_dfGE$condition == "pre",]$condition <- "Prima simulazione"
long_dfGE[long_dfGE$condition == "post",]$condition <- "Seconda simulazione"

```

## Explorative by groups

Note random:

- Come definiamo i comportamenti piÃ¹ cooperativi/competitivi?Credo il distacco tra "contributo comune rigenerazione" e "mucche acquisite a settimana", focalizzandoci su capitale totale, mucche perse ed energia acquisita.

- Di fatto anche se inizialmente hanno investito (settimana 14 nella seconda simulazione), nelle settimane succesive molti gruppi tornano ad acrescere le proprie mucche.

- Da matchare medie dei gruppi ai questionari con scelte ed output simulazione, e discussione gruppi

```{r read_data, echo=FALSE}

variables <- c("Capitale totale","Guadagno giornaliero","Contributo comune rigenerazione","Mucche acquisite a settimana",
         "Mucche in vita","Mucche perse","Energia acquisita","Risorse ambientali","Giorni in vita farmers","Giorno")

for (i in variables){
 
plot_i <- long_dfGE[long_dfGE$output == i,] %>% ggplot(aes(x = time, y = score)) + geom_line(aes(color = group_color)) +
  scale_color_manual("gruppo", values=c(azzurro="cyan", blu="blue", rosso = "red",giallo = "yellow",rosa = "pink")) +
  scale_x_continuous(breaks=seq(0,35,7)) +
facet_grid(turn ~ factor(condition, levels = c("Prima simulazione","Seconda simulazione")), scales = "free_y") +
  labs(title = i, x = "giorni", y = i) + 
  theme_bw( ) + 
  theme(
    axis.text.x = element_text(angle = 45),legend.position = "bottom")
  
plot(plot_i)

}
```